<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>Finish signing up</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css"
    />
    <!-- Remix Icon -->
    <link
      href="https://cdn.jsdelivr.net/npm/remixicon/fonts/remixicon.css"
      rel="stylesheet"
    />

    <style>
      @import url("https://fonts.googleapis.com/css2?family=playfair+Display:wght@100..400&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap");

      :root {
        --primary-color: #1d1143;
        --secondary-color: #4b96d0;
        --white: #ffffff;
        --text-light: #d1d5db;
        --header-font: "playfair Display", serif;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      body {
        background: #fff;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
        color: #333;
        padding: 20px;
        margin: 0;
      }

      .container {
        width: 100%;
        max-width: 420px;
        margin: 0 auto;
        flex: 1;
      }

      .title {
        font-size: 24px;
        font-weight: bold;
        margin: 15px 0;
        text-align: left;
        color: #1d1143;
      }

      .form-group {
        margin-bottom: 16px;
      }

      .form-group label {
        display: block;
        font-size: 14px;
        margin-bottom: 6px;
        color: #444;
        font-weight: 500;
      }

      .form-group input {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 8px;
        outline: none;
      }

      .input-group {
        margin-bottom: 16px;
      }

      .input-group label {
        display: block;
        font-size: 14px;
        margin-bottom: 6px;
        color: #444;
      }

      .input-group select {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 8px;
        outline: none;
        appearance: none;
        background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 10px center;
        background-size: 16px;
      }

      .sub-note {
        font-size: 12px;
        color: #666;
        line-height: 1.4;
        margin: 6px 0 16px 0;
      }

      .date-note {
        font-size: 12px;
        color: #666;
        line-height: 1.4;
        margin-bottom: 16px;
      }

      .password-container {
        position: relative;
        margin-bottom: 20px;
      }

      .password-container input {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 8px;
        outline: none;
        appearance: none;
      }

      .password-container label {
        display: block;
        font-size: 14px;
        margin-bottom: 6px;
        color: #444;
        font-weight: 700;
      }

      .show-password {
        position: absolute;
        right: 12px;
        top: 42px;
        background: none;
        border: none;
        color: #4b96d0;
        font-size: 14px;
        cursor: pointer;
        padding: 4px 8px;
      }

      .btnbook {
        background-color: rgb(111, 163, 247);
        color: #fff;
        font-size: 16px;
        cursor: pointer;
        width: auto;
        border: none;
        padding: 8px 12px;
        margin: 0;
        border-radius: 6px;
        transition: all 0.3s ease-in-out;
      }

      .btnbook:hover {
        transform: scale(1.05);
      }

      .btn-submit {
        width: 100%;
        padding: 12px;
        font-size: 16px;
        background: rgb(138, 170, 244);
        color: #1d1143;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease-in-out;
        font-weight: 600;
        margin-top: 10px;
      }

      .btn-submit:hover {
        background: rgb(75, 144, 217);
        transform: scale(1.02);
      }

      input[type="date"] {
        min-height: 44px;
      }

      #password-strength-meter {
        margin-top: 10px;
      }

      #password-strength-text {
        font-size: 12px;
        margin-top: 4px;
      }

      .password-suggestion {
        margin-bottom: 16px;
      }

      #password-suggestion {
        font-size: 14px;
        padding: 12px;
      }

      /* Footer Styles */
      .footer {
        background: #1a193f;
      }

      .footer__contanier {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr; /* 3 أعمدة */
        gap: 4rem 2rem;
      }

      .footer__logo {
        margin-bottom: 2rem;
        color: #82c9ff;
      }
      .footer__logo span {
        line-height: 1.2;
        font-family: "playfair Display", serif;
        font-size: 26px;
        font-weight: bold;
        color: #82c9ff;
      }
      .footer__logo div {
        background: #82c9ff;
        color: #1a193f;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 0px;
        font-weight: bold;
        font-size: 24px;
      }

      .footer__socials {
        list-style: none;
        margin-top: 2rem;
        display: flex;
        align-items: center;
        gap: 1rem;
      }

      .footer__socials a {
        padding: 6px 10px;
        font-size: 1.25rem;
        color: var(--text-light);
        background-color: azure;
        border-radius: 100%;
        cursor: pointer;
        transition: 0.3s;
      }

      .footer__socials a:hover {
        color: #f8f8f8;
        background-color: #9cb5ff;
      }

      .footer__col h4 {
        margin-bottom: 2.5rem;
        font-size: 1.25rem;
        font-weight: 800;
        font-family: "playfair Display", serif;
        color: #f8f8f8;
      }

      .footer__links {
        list-style: none;
      }

      .footer__links li {
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
      }

      .footer__links a {
        color: #fff;
        transition: 0.3s;
        gap: 1rem;
      }

      .footer__links a:hover {
        color: #82c9ff;
      }

      .footer__col:last-child .footer__links li {
        margin-bottom: 2rem;
      }

      .footer__links span {
        font-size: 2rem;
        color: #82c9ff;
      }

      .footer__links h5 {
        margin-bottom: 0.5rem;
        font-size: 1rem;
        font-weight: 800;
        font-family: "playfair Display", serif;
        color: #fff;
      }

      .footer__links p {
        color: #fff;
      }

      .footer__bar {
        padding: 1rem;
        font-size: 0.8rem;
        color: white;
        text-align: center;
      }
      .section__description {
        color: #fcfcfc;
      }
      .custom-divider {
        border: none;
        height: 1px;
        background-color: rgba(0, 0, 0, 0.1);
        margin: 50px auto 30px;
        width: 85%;
      }

      @media (max-width: 375px) {
        body {
          padding: 15px;
        }

        .title {
          font-size: 22px;
        }

        .form-group input,
        .input-group select {
          padding: 10px;
          font-size: 15px;
        }

        .btn-submit {
          padding: 12px;
          margin-bottom: 40px;
          font-size: 15px;
        }

        .footer__contanier {
          grid-template-columns: repeat(2, 1fr);
        }

        .footer__col:first-child {
          grid-column: 1/3;
        }
      }
    </style>
  </head>
  <body>
    <form id="signupForm">
      <div class="container">
        <h1 class="title">Finish signing up</h1>
        <div class="form-group">
          <label for="firstNameID">User Name</label>
          <input type="text" id="firstNameID" placeholder="Full name" />
        </div>
        <div class="sub-note">
          Make sure this matches the name on your government ID. If you go by
          another name, you can add a preferred first name.
        </div>
        <div class="input-group">
          <select id="universityId">
            <option value="0" disabled selected>Choose your university</option>
            <option value="1">Minia University</option>
            <option value="2">Minia National University</option>
            <option value="4">
              Higher Institute of Engineering and Technology
            </option>
            <option value="5">Languages Institute</option>
          </select>
        </div>

        <div class="input-group">
          <select id="collegeId">
            <option value="0" disabled selected>Choose your faculty</option>
            <option value="101">Faculty of Medicine</option>
            <option value="102">Faculty of Engineering</option>
            <option value="103">Faculty of Pharmacy</option>
            <option value="104">Faculty of Dentistry</option>
            <option value="105">Faculty of Science</option>
            <option value="106">Faculty of Nursing</option>
            <option value="107">Faculty of Agriculture</option>
            <option value="108">Faculty of Education</option>
            <option value="109">Faculty of Physical Education</option>
            <option value="110">Faculty of Al-Alsun</option>
            <option value="111">Faculty of Arts</option>
            <option value="112">Faculty of Specific Education</option>
            <option value="113">Faculty of Physical Education</option>
            <option value="114">Faculty of Al-Alsun</option>
            <option value="115">Faculty of Arts</option>
            <option value="116">Faculty of Dar Al-Uloom</option>
            <option value="117">Faculty of Tourism and Hotels</option>
            <option value="118">Faculty of Computers and Information</option>
            <option value="119">Faculty of Early Childhood Education</option>
            <option value="120">Faculty of Physical Therapy</option>
            <option value="121">Faculty of Engineering</option>
            <option value="122">Faculty of Artificial Intelligence</option>
            <option value="123">Faculty of Business Administration</option>
            <option value="124">Faculty of Law</option>
            <option value="125">Faculty of Civil Engineering</option>
            <option value="125">
              Faculty of Electronics and Communication Engineering
            </option>
            <option value="126">
              Electrical Power and Machines Engineering
            </option>
            <option value="127">Faculty of English Language</option>
            <option value="128">Faculty of German Language</option>
            <option value="129">Faculty of French Language</option>
          </select>
        </div>

        <div class="sub-note">Make sure this University</div>

        <div class="form-group">
          <label for="address">Address</label>
          <input type="text" id="address" placeholder="Enter your address" />
        </div>
        <div class="sub-note">Please provide your current address</div>
        <div class="date-note">
          Enter your address in full details as it appears on your ID or
          government document.
        </div>

        <div class="form-group">
          <label for="phone">Phone number</label>
          <input type="tel" id="phone" placeholder="Enter your phone number" />
        </div>

        <div class="form-group">
          <label for="email">Email</label>
          <input type="email" id="email" placeholder="user@gmail.com" />
        </div>

        <div class="password-container">
          <label for="signup-password">Password</label>
          <input
            type="password"
            id="signup-password"
            placeholder="Enter your password"
          />
          <button type="button" class="show-password" id="togglePasswordBtn">
            Show
          </button>
          <div id="password-strength-meter" style="margin-top: 8px">
            <div style="display: flex; height: 4px; margin-bottom: 4px">
              <div
                id="strength-bar-1"
                style="
                  flex: 1;
                  background: #e0e0e0;
                  margin: 0 2px;
                  border-radius: 2px;
                "
              ></div>
              <div
                id="strength-bar-2"
                style="
                  flex: 1;
                  background: #e0e0e0;
                  margin: 0 2px;
                  border-radius: 2px;
                "
              ></div>
              <div
                id="strength-bar-3"
                style="
                  flex: 1;
                  background: #e0e0e0;
                  margin: 0 2px;
                  border-radius: 2px;
                "
              ></div>
              <div
                id="strength-bar-4"
                style="
                  flex: 1;
                  background: #e0e0e0;
                  margin: 0 2px;
                  border-radius: 2px;
                "
              ></div>
            </div>
            <div
              id="password-strength-text"
              style="font-size: 12px; color: #666"
            ></div>
          </div>
        </div>

        <div class="password-suggestion" style="margin-bottom: 16px">
          <div style="display: flex; gap: 8px; margin-bottom: 4px">
            <input
              type="text"
              id="password-suggestion"
              placeholder="Click generate for a strong password"
              readonly
              style="
                flex: 1;
                padding: 12px;
                border: 1px solid #ccc;
                border-radius: 8px;
                font-size: 14px;
              "
            />
            <button
              type="button"
              id="generate-password"
              class="btnbook"
              style="width: auto; padding: 0 12px"
            >
              Generate
            </button>
          </div>
          <div class="sub-note" style="font-size: 12px">
            <i class="fas fa-lightbulb" style="color: #ffc107"></i> Strong
            passwords contain uppercase, lowercase, numbers and special
            characters
          </div>
        </div>

        <button class="btn-submit" type="submit">Agree and continue</button>
      </div>
    </form>
    <hr class="custom-divider" />

    <footer class="footer" id="contact">
      <div class="section__contanier footer__contanier">
        <div class="footer__col">
          <div
            class="logo footer__logo"
            style="display: flex; align-items: center; gap: 10px"
          >
            <div
              style="
                background: #82c9ff;
                color: #1a193f;
                width: 40px;
                height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 8px;
                font-weight: bold;
                font-size: 24px;
              "
            >
              E
            </div>
            <span
              style="
                font-size: 20px;
                font-weight: bold;
                color: #82c9ff;

                line-height: 1.2;
              "
              >EASY<br />
              RENT</span
            >
          </div>
          <p class="section__description">
            Easy rent is dedicated to simplifying the process of finding student
            accommandations, it enables a seamless connection between students
            and owners.
          </p>
          <ul class="footer__socials">
            <li>
              <a href="#" target="_blank"><i class="ri-facebook-line"></i></a>
            </li>
            <li>
              <a href="#" target="_blank"><i class="ri-instagram-line"></i></a>
            </li>
            <li>
              <a href="#" target="_blank"><i class="ri-linkedin-line"></i></a>
            </li>
          </ul>
        </div>

        <div class="footer__col">
          <h4>Services</h4>
          <div class="footer__links">
            <li><a href="#">Online Booking</a></li>
            <li><a href="privacypolicy.html">Privacy Policy</a></li>
            <li><a href="#"> Spical offer</a></li>
            <li><a href="#">Room Customization</a></li>
            <li><a href="#">Customer Support</a></li>
          </div>
        </div>
        <div class="footer__col">
          <h4>Contact Us</h4>
          <div class="footer__links">
            <li>
              <span><i class="ri-phone-fill"></i></span>
              <div>
                <h5>Phone Number</h5>
                <p>+20 1224170048</p>
              </div>
            </li>
            <li>
              <span><i class="ri-record-mail-line"></i></span>
              <div>
                <h5>Email</h5>
                <p>info@easyrent15.com</p>
              </div>
            </li>
            <li>
              <span><i class="ri-map-pin-2-fill"></i></span>
              <div>
                <h5>Location</h5>
                <p>Minya st. Taha-Hessien</p>
              </div>
            </li>
          </div>
        </div>
      </div>
      <div class="footer__bar">
        EasyRent copyright 2025 web Design .All rights reserved.
      </div>
    </footer>
    
      <script type="module">
        document.addEventListener("DOMContentLoaded", () => {
          const form = document.getElementById("signupForm");
          const uniSelect = document.getElementById("universityId");
          const collegeSelect = document.getElementById("collegeId");
          const passwordInput = document.getElementById("signup-password");
          const togglePasswordBtn = document.getElementById("togglePasswordBtn");
          const generateBtn = document.getElementById("generate-password");
          const passwordSuggestion = document.getElementById(
            "password-suggestion"
          );
          const strengthBars = [
            document.getElementById("strength-bar-1"),
            document.getElementById("strength-bar-2"),
            document.getElementById("strength-bar-3"),
            document.getElementById("strength-bar-4"),
          ];
          const strengthText = document.getElementById("password-strength-text");
  
          // تحميل الجامعات
          async function loadUniversities() {
            try {
              const res = await fetch(
                "https://easyrentapi0.runasp.net/api/University"
              );
              if (!res.ok) throw new Error("Failed to load universities");
              const data = await res.json();
              data.forEach((u) => {
                const option = document.createElement("option");
                option.value = u.id;
                option.textContent = u.name;
                uniSelect.appendChild(option);
              });
            } catch (err) {
              alert("Error loading universities: " + err.message);
            }
          }
  
          // تحميل الكليات
          async function loadColleges() {
            try {
              const res = await fetch(
                "https://easyrentapi0.runasp.net/api/Colleges"
              );
              if (!res.ok) throw new Error("Failed to load colleges");
              const data = await res.json();
              data.forEach((c) => {
                const option = document.createElement("option");
                option.value = c.id;
                option.textContent = c.name;
                collegeSelect.appendChild(option);
              });
            } catch (err) {
              alert("Error loading colleges: " + err.message);
            }
          }
  
          // تحقق قوة كلمة المرور
          function checkPasswordStrength() {
            const val = passwordInput.value;
            let strength = 0;
            if (val.length >= 8) strength++;
            if (/[A-Z]/.test(val)) strength++;
            if (/[0-9]/.test(val)) strength++;
            if (/[^A-Za-z0-9]/.test(val)) strength++;
  
            strengthBars.forEach((bar, i) => {
              bar.style.background = i < strength ? "#4caf50" : "#e0e0e0";
            });
  
            const texts = [
              "Very Weak",
              "Weak",
              "Medium",
              "Strong",
              "Very Strong",
            ];
            strengthText.textContent = texts[strength];
          }
  
          // حفظ بيانات النموذج مؤقتًا في localStorage
          function saveFormData() {
            const data = {
              name: document.getElementById("firstNameID").value.trim(),
              email: document.getElementById("email").value.trim(),
              phone: document.getElementById("phone").value.trim(),
              address: document.getElementById("address").value.trim(),
              password: passwordInput.value,
              universityId: uniSelect.value,
              collegeId: collegeSelect.value,
            };
            localStorage.setItem("signupFormData", JSON.stringify(data));
          }
  
          // تحميل بيانات محفوظة من localStorage
          function loadFormData() {
            const saved = localStorage.getItem("signupFormData");
            if (!saved) return;
            const data = JSON.parse(saved);
            if (data.name)
              document.getElementById("firstNameID").value = data.name;
            if (data.email) document.getElementById("email").value = data.email;
            if (data.phone) document.getElementById("phone").value = data.phone;
            if (data.address)
              document.getElementById("address").value = data.address;
            if (data.password) {
              passwordInput.value = data.password;
              checkPasswordStrength();
            }
            if (data.universityId) uniSelect.value = data.universityId;
            if (data.collegeId) collegeSelect.value = data.collegeId;
          }
  
          // توليد كلمة مرور من API
          generateBtn.addEventListener("click", async () => {
            try {
              const res = await fetch(
                "https://easyrentapi0.runasp.net/api/Auth/generate-password"
              );
              if (!res.ok) throw new Error("Failed to generate password");
              const data = await res.json();
              passwordSuggestion.value = data.password || "";
              passwordInput.value = data.password || "";
              checkPasswordStrength();
              saveFormData();
            } catch (err) {
              alert("Error generating password: " + err.message);
            }
          });
  
          // زر إظهار وإخفاء كلمة المرور
          togglePasswordBtn.addEventListener("click", () => {
            if (passwordInput.type === "password") {
              passwordInput.type = "text";
              togglePasswordBtn.textContent = "Hide";
            } else {
              passwordInput.type = "password";
              togglePasswordBtn.textContent = "Show";
            }
          });
  
          // استماع لتغييرات الحقول لحفظ البيانات وتقييم كلمة المرور
          document.querySelectorAll("input, select").forEach((el) => {
            el.addEventListener("input", () => {
              saveFormData();
              if (el === passwordInput) checkPasswordStrength();
            });
          });
  
          // إرسال النموذج والتسجيل
          form.addEventListener("submit", async (e) => {
            e.preventDefault();
  
            const payload = {
              name: document.getElementById("firstNameID").value.trim(),
              email: document.getElementById("email").value.trim(),
              userName: document.getElementById("firstNameID").value.trim(),
              password: passwordInput.value,
              phoneNumber: document.getElementById("phone").value.trim(),
              address: document.getElementById("address").value.trim(),
              universityId: parseInt(uniSelect.value),
              collegeId: parseInt(collegeSelect.value),
            };
  
            if (!payload.name || !payload.email || !payload.password) {
              alert("Please fill in all required fields.");
              return;
            }
            if (payload.universityId === 0 || isNaN(payload.universityId)) {
              alert("Please select a valid University.");
              return;
            }
            if (payload.collegeId === 0 || isNaN(payload.collegeId)) {
              alert("Please select a valid College.");
              return;
            }
            if (payload.password.length < 8) {
              alert("Password must be at least 8 characters.");
              return;
            }
            const strongRegex =
              /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z0-9])/;
            if (!strongRegex.test(payload.password)) {
              alert(
                "Password must contain uppercase, lowercase, number, and special character."
              );
              return;
            }
  
            try {
              const res = await fetch(
                "https://easyrentapi0.runasp.net/api/Student/register",
                {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify(payload),
                }
              );
              if (!res.ok) {
                const errorText = await res.text();
                alert("Error: " + errorText);
                return;
              }
              alert("Registration successful!");
              localStorage.removeItem("signupFormData");
              // redirect to login or next page:
               window.location.href = "login.html";
            } catch (err) {
              alert("Network error: " + err.message);
            }
          });
  
          // تهيئة الصفحة
          (async function init() {
            await loadUniversities();
            await loadColleges();
            loadFormData();
          })();
        });
      </script>
    </script>
  </body>
</html>
